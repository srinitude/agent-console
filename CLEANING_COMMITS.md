# Removing AI Attributions from Git Commit Messages

This guide explains how to remove AI-related attributions from commit messages in your git history, both locally and remotely.

## What Gets Removed

The script removes the following from commit messages:
- `Co-Authored-By` lines mentioning AI tools (Claude, Anthropic, Cursor, Warp, Copilot, or any "bot"/"AI"/"assistant")
- Lines starting with "Generated by [AI tool]"
- Lines starting with "Created with [AI tool]"
- Lines starting with "Authored by [AI tool]"
- Lines starting with "Assisted by [AI tool]"
- Other AI tool attribution patterns

## What Gets Kept

- Regular commit message content
- `Co-Authored-By` lines for human contributors
- All other commit message metadata

## Quick Start

### Clean All Commits on Current Branch

```bash
./clean-commit-messages.sh
```

This will:
1. Create a backup branch
2. Rewrite all commits on the current branch
3. Remove AI attributions from commit messages
4. Show you next steps

### Clean Specific Commit Range

```bash
# Clean last 5 commits
./clean-commit-messages.sh HEAD~5..HEAD

# Clean all commits since a specific commit
./clean-commit-messages.sh abc1234..HEAD

# Clean specific branch
./clean-commit-messages.sh feature-branch
```

## Step-by-Step Guide

### 1. Backup Your Work

The script automatically creates a backup branch, but you can also manually backup:

```bash
git branch backup-$(date +%Y%m%d)
```

### 2. Run the Cleaning Script

```bash
./clean-commit-messages.sh
```

The script will:
- Show you what it's about to do
- Ask for confirmation
- Create a backup branch
- Rewrite the commit history

### 3. Review the Changes

Check that the commits were cleaned correctly:

```bash
# View commit messages
git log --oneline -10

# View full commit message for a specific commit
git log -1 --format=fuller <commit-sha>

# Compare with backup
git log --oneline backup-before-cleanup-YYYYMMDD-HHMMSS
```

### 4. Push to Remote (If Needed)

#### Option A: Force Push (Rewrites Remote History)

⚠️ **WARNING**: This will rewrite history on GitHub!

```bash
# Use --force-with-lease for safety (fails if remote has changes you don't have)
git push --force-with-lease origin <branch-name>

# Or use --force if you're sure (less safe)
git push --force origin <branch-name>
```

#### Option B: Create a New Branch

If you don't want to rewrite remote history, create a new branch:

```bash
git checkout -b <branch-name>-cleaned
git push origin <branch-name>-cleaned
```

Then create a new pull request with the cleaned branch.

### 5. Notify Collaborators (If You Force Pushed)

If you force pushed, all collaborators need to reset their local branches:

```bash
git fetch origin
git reset --hard origin/<branch-name>
```

## Undo Changes

If you're not happy with the results:

```bash
# Find your backup branch
git branch | grep backup

# Reset to backup
git reset --hard backup-before-cleanup-YYYYMMDD-HHMMSS

# Delete the backup branch (optional)
git branch -D backup-before-cleanup-YYYYMMDD-HHMMSS
```

## Manual Method (Without Script)

If you prefer to do it manually with git filter-branch:

```bash
git filter-branch --msg-filter '
    sed "/^Co-[Aa]uthored-[Bb]y:.*\(claude\|anthropic\|cursor\|warp\|copilot\|bot\|ai\|assistant\|automated\)/Id;
         /^Generated by.*\(claude\|copilot\|cursor\|ai\|assistant\|bot\)/Id;
         /^Created with.*\(claude\|copilot\|cursor\|ai\|assistant\|bot\)/Id;
         /^Assisted by.*\(claude\|copilot\|cursor\|ai\|assistant\|bot\)/Id"
' --force HEAD
```

## Alternative: Interactive Rebase (For Recent Commits)

For a small number of recent commits, you can use interactive rebase:

```bash
# Rebase last 5 commits
git rebase -i HEAD~5

# In the editor, change "pick" to "reword" for commits you want to edit
# Save and close

# For each commit, edit the message to remove AI attributions
# Save and close each time
```

## Troubleshooting

### "Cannot create a new backup because one already exists"

Remove old backup branches first:

```bash
git branch -D backup-before-cleanup-*
```

### Force push rejected

Your remote has changes you don't have locally:

```bash
# Fetch latest changes
git fetch origin

# If you're sure you want to overwrite remote
git push --force origin <branch-name>
```

### Collaborators get conflicts after force push

They need to reset their branches:

```bash
# Backup any local changes first!
git fetch origin
git reset --hard origin/<branch-name>
```

## Best Practices

1. **Always create a backup** before rewriting history
2. **Coordinate with your team** before force pushing
3. **Use `--force-with-lease`** instead of `--force` when possible
4. **Test on a feature branch first** before cleaning main branches
5. **Document the change** in your team's communication channels

## Security Note

Rewriting git history does NOT remove data from GitHub permanently:
- Old commits are still accessible via their SHA for ~90 days
- Force pushes are logged in the repository
- Pull requests may still reference old commits

If you accidentally committed secrets, use tools like `git-filter-repo` or GitHub's secret scanning instead.
